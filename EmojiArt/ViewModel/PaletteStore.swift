//
//  PaletteStore.swift
//  EmojiArt
//
//  Created by æŸ´é•¿æž— on 2022/3/26.
//

import Foundation
import Combine

struct Palette: Identifiable {
    let id: String = UUID().uuidString
    var name: String
    var emojis: String
}

final class PaletteStore: ObservableObject {
    let name: String

    @Published var palettes: [Palette] = []

    init(named name: String) {
        self.name = name
        if palettes.isEmpty {
            palettes = [
                Palette(name: "Vehicles", emojis: "ðŸš™ðŸš—ðŸš˜ðŸš•ðŸš–ðŸŽðŸššðŸ›»ðŸš›ðŸšðŸš“ðŸš”ðŸš‘ðŸš’ðŸš€âœˆï¸ðŸ›«ðŸ›¬ðŸ›©ðŸšðŸ›¸ðŸš²ðŸðŸ›¶â›µï¸ðŸš¤ðŸ›¥ðŸ›³â›´ðŸš¢ðŸš‚ðŸšðŸš…ðŸš†ðŸšŠðŸš‰ðŸš‡ðŸ›ºðŸšœ"),
                Palette(name: "Sports", emojis: "ðŸˆâš¾ï¸ðŸ€âš½ï¸ðŸŽ¾ðŸðŸ¥ðŸ“â›³ï¸ðŸ¥…ðŸ¥ŒðŸ‚â›·ðŸŽ³"),
                Palette(name: "Music", emojis: "ðŸŽ¼ðŸŽ¤ðŸŽ¹ðŸª˜ðŸ¥ðŸŽºðŸª—ðŸª•ðŸŽ»"),
                Palette(name: "Animals", emojis: "ðŸ¥ðŸ£ðŸ‚ðŸ„ðŸŽðŸ–ðŸðŸ‘ðŸ¦™ðŸðŸ“ðŸðŸ€ðŸ’ðŸ¦†ðŸ¦…ðŸ¦‰ðŸ¦‡ðŸ¢ðŸðŸ¦ŽðŸ¦–ðŸ¦•ðŸ…ðŸ†ðŸ¦“ðŸ¦ðŸ¦§ðŸ¦£ðŸ˜ðŸ¦›ðŸ¦ðŸªðŸ«ðŸ¦’ðŸ¦˜ðŸ¦¬ðŸƒðŸ¦™ðŸðŸ¦ŒðŸ•ðŸ©ðŸ¦®ðŸˆðŸ¦¤ðŸ¦¢ðŸ¦©ðŸ•ŠðŸ¦ðŸ¦¨ðŸ¦¡ðŸ¦«ðŸ¦¦ðŸ¦¥ðŸ¿ðŸ¦”"),
                Palette(name: "Animal Faces", emojis: "ðŸµðŸ™ˆðŸ™ŠðŸ™‰ðŸ¶ðŸ±ðŸ­ðŸ¹ðŸ°ðŸ¦ŠðŸ»ðŸ¼ðŸ»â€â„ï¸ðŸ¨ðŸ¯ðŸ¦ðŸ®ðŸ·ðŸ¸ðŸ²"),
                Palette(name: "Flora", emojis: "ðŸŒ²ðŸŒ´ðŸŒ¿â˜˜ï¸ðŸ€ðŸðŸ„ðŸŒ¾ðŸ’ðŸŒ·ðŸŒ¹ðŸ¥€ðŸŒºðŸŒ¸ðŸŒ¼ðŸŒ»"),
                Palette(name: "Weather", emojis: "â˜€ï¸ðŸŒ¤â›…ï¸ðŸŒ¥â˜ï¸ðŸŒ¦ðŸŒ§â›ˆðŸŒ©ðŸŒ¨â„ï¸ðŸ’¨â˜”ï¸ðŸ’§ðŸ’¦ðŸŒŠâ˜‚ï¸ðŸŒ«ðŸŒª"),
                Palette(name: "COVID", emojis: "ðŸ’‰ðŸ¦ ðŸ˜·ðŸ¤§ðŸ¤’"),
                Palette(name: "Faces", emojis: "ðŸ˜€ðŸ˜ƒðŸ˜„ðŸ˜ðŸ˜†ðŸ˜…ðŸ˜‚ðŸ¤£ðŸ¥²â˜ºï¸ðŸ˜ŠðŸ˜‡ðŸ™‚ðŸ™ƒðŸ˜‰ðŸ˜ŒðŸ˜ðŸ¥°ðŸ˜˜ðŸ˜—ðŸ˜™ðŸ˜šðŸ˜‹ðŸ˜›ðŸ˜ðŸ˜œðŸ¤ªðŸ¤¨ðŸ§ðŸ¤“ðŸ˜ŽðŸ¥¸ðŸ¤©ðŸ¥³ðŸ˜ðŸ˜žðŸ˜”ðŸ˜ŸðŸ˜•ðŸ™â˜¹ï¸ðŸ˜£ðŸ˜–ðŸ˜«ðŸ˜©ðŸ¥ºðŸ˜¢ðŸ˜­ðŸ˜¤ðŸ˜ ðŸ˜¡ðŸ¤¯ðŸ˜³ðŸ¥¶ðŸ˜¥ðŸ˜“ðŸ¤—ðŸ¤”ðŸ¤­ðŸ¤«ðŸ¤¥ðŸ˜¬ðŸ™„ðŸ˜¯ðŸ˜§ðŸ¥±ðŸ˜´ðŸ¤®ðŸ˜·ðŸ¤§ðŸ¤’ðŸ¤ "),
            ]
        }
    }

    func pallete(at idx: Int) -> Palette {
        let index = min(max(idx, 0), palettes.count - 1)
        return palettes[index]
    }

    @discardableResult
    func removePalette(at index: Int) -> Int {
        if !palettes.isEmpty, palettes.indices.contains(index) {
            palettes.remove(at: index)
        }
        return index % palettes.count
    }

    func insertPalette(named name: String, emojis: String? = nil, at index: Int = 0) {
        let palette = Palette(name: name, emojis: emojis ?? "")
        let safeIdx = min(max(index, 0), palettes.count)
        palettes.insert(palette, at: safeIdx)
    }
}
